<!-- sign-in.njk -->
{% extends "layouts/_layout.njk" %}
{% set title = "Sign in" %}
{% set logoColor = "#ffffff" %}
{% set navbarFull = true %}
{% set fullScreen = true %}

<script>
    var myObjectName = 132;
</script>

{% block content %}
    <section id="content">
        <div class="bg-image bg-cover w-100 vh-100" style="background-color: #f1f4f8;"></div>
        <div class="container">
            <div class="row vh-100 text-center justify-content-center align-items-center">
                <div class="col-11 col-md-8 col-lg-5">
                    <div class="row">
                        <div class="square d-flex w-100 mt-5">
                            <div class="square-inner bg-white border mx-auto p-4 p-lg-6 d-flex flex-column w-100 justify-content-center">
                                <span id="error" style="color: red; display:none">Invalid Login. Pleasy try again</span>
                                <h1>Sign In</h1>
                                <div class="form-group">
                                    <input class="form-control form-control-lg" id="email" type="email" placeholder="Email address" aria-label="Email address" />
                                </div>
                                <div class="form-group mb-5">
                                    <input class="form-control form-control-lg" id="password" type="password" placeholder="Password" aria-label="Password" />
                                </div>
                                <div class="form-group">
                                    <button type="button" onClick="fetch("https://employer-web-client-iota-ashen.vercel.app/login", {
                                        method: 'post',
                                        headers: {
                                            'Accept': 'application/json, text/plain, */*',
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify({username_or_email: document.getElementById('email').value, password: document.getElementById('password').value})
                                        }).then(res => res.json())
                                        .then(res => {
                                            console.log(res);
                                            if(res['non_field_errors']) document.getElementById('error').style.display = 'block';
                                            else window.location.href = 'https://employer-web-client-iota-ashen.vercel.app/?token=' + res['token'];
                                        });"class="btn btn-primary btn-lg btn-block text-uppercase">Sign In</button>
                                </div>
                                <p class="small text-muted mb-0">Don't have an account yet? <a href="https://employer.jobcore.co/signup" class="text-secondary text-underline">Sign Up</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}